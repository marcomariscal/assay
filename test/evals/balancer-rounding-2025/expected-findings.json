{
  "exploit": {
    "name": "Balancer V2 Rounding Error Exploit",
    "date": "2025-11-03",
    "loss": "$128M",
    "chains": ["ethereum", "arbitrum", "base", "optimism", "polygon", "gnosis"],
    "reference": "https://research.checkpoint.com/2025/how-an-attacker-drained-128m-from-balancer-through-rounding-error-exploitation/"
  },
  "expectedFindings": [
    {
      "code": "PRECISION_LOSS",
      "level": "warning",
      "pattern": "mulDown used in critical math without minimum value guard",
      "location": "_upscaleArray"
    },
    {
      "code": "ROUNDING_TO_ZERO",
      "level": "warning",
      "pattern": "Division in loop can compound rounding errors",
      "location": "_computeStableInvariant"
    },
    {
      "code": "MISSING_MIN_CHECK",
      "level": "warning",
      "pattern": "No minimum balance requirement before scaling operation",
      "location": "_upscaleArray"
    }
  ],
  "aiExpectedConcerns": [
    {
      "category": "precision_rounding",
      "severity": "high",
      "title": "Rounding error exploitation at small balances",
      "minConfidence": 80
    }
  ],
  "attackVector": {
    "description": "Attacker pushes token balance to 8-9 wei boundary, executes batched swaps to compound precision loss, suppresses BPT price, extracts value via arbitrage",
    "steps": [
      "Push one token balance to rounding boundary (8-9 wei)",
      "Execute 65+ micro-swaps in single batchSwap",
      "Each swap compounds precision error in invariant calculation",
      "BPT price artificially suppressed",
      "Mint BPT at low price, redeem at full value"
    ]
  }
}
